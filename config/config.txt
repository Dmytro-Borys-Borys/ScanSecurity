CONFIG_DIR="$(dirname "$(readlink -f "$BASH_SOURCE")")"
BASE_DIR="$(dirname "$CONFIG_DIR")"
NETWORK_CONFIG="${CONFIG_DIR}/netconfig.txt"
AUTH_CONFIG="${CONFIG_DIR}/authconfig.txt"
RADIUS_DB="/etc/freeradius/3.0/freeradius.db"


NDS_PAGE="splash.html"
NDS_LOGO="52.webp"

set_scriptdir() {
    local location="$1"
    SCRIPT_DIR="$(dirname "$(readlink -f "$location")")"
}

attempt_to_load() {
    local file="$1"

    # Check if the file exists
    if [ ! -f "$file" ]; then
    echo "File not found: $file"
    exit 1  # Terminate the script with a non-zero exit code
    fi

    # Continue with the rest of the script if the file exists
    source "$file"
    echo "File loaded: $file"
}

create_symbolic_link() {
    local target_path="$1"
    local link_path="$2"
    local owner="$3"

    # Borrar el archivo si ya existe
    delete_if_exists "$link_path"

    # Crear un enlace simbólico
    sudo ln -sv "$target_path" "$link_path"


    # Cambiar el dueño
    sudo chown -v "$owner:$owner" "$link_path"
}

delete_if_exists() {
    local file="$1"

    if [ -e "$file" ]; then
        if [ -d "$file" ]; then
            # Delete the directory and its contents with force
            sudo rm -rfv "$file"
        elif [ -L "$file" ]; then
            # Delete the symbolic link
            sudo rm -v "$file"
        else
            # Delete the file
            sudo rm -v "$file"
        fi
    fi
}


write_template_to_file() {
    local template="$1"
    local target_file="$2"

    # Borrar el archivo si ya existe
    delete_if_exists "$target_file"
    echo "$template" > "$target_file"
    echo "written '$target_file'"
}

add_to_rc_local() {
    line=$1
    file="/etc/rc.local"
    # Check if the line exists in the file
    if grep -qF "$line" "$file"; then
        echo "Line already exists in $file"
    else
        # Add the line above "exit 0" in the file
        sudo sed -i "/^exit 0/i $line" "$file"
        echo "Line added to $file"
    fi
}